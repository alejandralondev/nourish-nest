<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Nourish Nest</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500&family=Jost:wght@500;600;700&display=swap" rel="stylesheet"> 

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="/lib/animate/animate.min.css" rel="stylesheet">
    <link href="/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="/lib/lightbox/css/lightbox.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="/css/style.css" rel="stylesheet">
</head>

<body>
    <div class="container-xxl bg-white p-0">
        <!-- Spinner Start -->
        <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
            <div class="spinner-grow text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
        <!-- Spinner End -->


        <!-- Navbar & Hero Start -->
        <div class="container-xxl position-relative p-0">
            <nav class="navbar navbar-expand-lg navbar-light px-4 px-lg-5 py-3 py-lg-0">
                <a href="" class="navbar-brand p-0">
                    <h1 class="m-0">Nourish Nest</h1>
                    <!-- <img src="img/logo.png" alt="Logo"> -->
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                    <span class="fa fa-bars"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <div class="navbar-nav mx-auto py-0">
                        <a href="/home" class="nav-item nav-link active">Home</a>
                        <a href="/about" class="nav-item nav-link">About</a>
                        <a href="/groceries" class="nav-item nav-link">Groceries</a>
                        <a href="/meals" class="nav-item nav-link">Meals</a>
                        <!-- <a href="/blog" class="nav-item nav-link">Blog</a> -->
                    </div>
                    <div>
                        <p><strong>User Name</strong>: <%= user.userName %></p>
                        <p><strong>Email</strong>: <%= user.email %></p>
                        <a href="/logout" class="btn rounded-pill py-2 px-4 ms-3 d-none d-lg-block">Logout</a>
                    </div>
                </div>
            </nav>

            <div class="container-xxl py-5 bg-primary hero-header mygroceries">
                <div class="container my-5 py-5 px-lg-5">
                    <div class="row g-5 py-5">
                        <div class="col-12 text-center">
                            <h1 class="text-white animated slideInDown">My Groceries</h1>
                            <hr class="bg-white mx-auto mt-0" style="width: 90px;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Navbar & Hero End -->


        <!-- Groceries Start -->
        <div class="container-xxl py-5 groceriesDiv">
            <div class="container py-5 px-lg-5">
                <div class="mt-5">
                    <div class="groceries-row">
                        <div>
                        <div class="add-item-form col-sm-6">
                            <h2>Add an item</h2>
                            <% if (user && user.email) { %>
                                <form action="/groceries/createGroceries" method="POST" name="groceryForm" class="groceryForm">
                                  <input type="text" placeholder="name of item" name="groceriesItem">
                                  <div>
                                    <label for="date-bought">Date Bought</label>
                                    <input type="date" class="form-control" name="dateBought" required>
                                  </div>
                                  <div>
                                    <label for="expiration-date">Expiration Date</label>
                                    <input type="date" class="form-control" name="expirationDate" required>
                                  </div>
                                  <div>
                                    <label for="macros">Macro Category</label>
                                    <select name="macros">
                                        <option value="select">-Select-</option>
                                        <option value="proteins">Proteins</option>
                                        <option value="carbs">Carbs</option>
                                        <option value="fats">Fats</option>
                                        <option value="fiber">Fiber</option>
                                    </select>
                                  </div>
                                  <div>
                                    <label for="food-type">Food Type</label>
                                    <select name="foodType">
                                        <option value="select">-Select-</option>
                                        <option value="vegetables">Vegetables</option>
                                        <option value="fruits">Fruits</option>
                                        <option value="grains">Grains</option>
                                        <option value="dairy">Dairy</option>
                                        <option value="meats">Meats</option>
                                        <option value="other">Other</option>
                                    </select>
                                  </div>
                                  <div>
                                    <label for="meal-type">Meal Type</label>
                                        <select name="mealType">
                                            <option value="select">-Select-</option>
                                            <option value="breakfast">Quick Breakfast</option>
                                            <option value="cooking-breakfast">Cooking Breakfast</option>
                                            <option value="dinner">Quick Dinner</option>
                                            <option value="cooking-dinner">Cooking Dinner</option>
                                            <option value="snacks">Snack</option>
                                        </select>
                                  </div>
                                  <!-- <input type="text" placeholder="note" name="msg"> -->
                                  <input type="text" placeholder="cost" name="price">
                                  <button type="submit" class="grocerySubmit">Submit</button>
                                </form>
                            <% } else { %>
                                    <!-- Handle the case when user or user.local.email is undefined -->
                                    <p>User or email not found</p>
                            <% } %>
                        </div>
                        <div><img class="Healthy-food" src="public/img/Healthy-food.jpg" alt=""></div>
                        </div>
                        <div class="grocery-tracking-row">
                            <div class="col-sm-6">
                                <h3>My Grocery Tracking</h3>
                                <ul class="list-group">
                                    <% groceries.forEach(grocery => { %>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>
                                                <span class="itemName"><strong>Name:</strong> <%= grocery.groceries %></span><br>
                                                <span class="dateBought"><strong>Date Bought:</strong> <%= new Date(grocery.dateBought).toLocaleDateString() %></span><br>
                                                <span class="expirationDate"><strong>Expiration Date:</strong> <%= new Date(grocery.expirationDate).toLocaleDateString() %></span><br>
                                                <!-- <span class="msg"><strong>Note:</strong> <%= grocery.msg %></span><br> -->
                                                <span class="price"><strong>Price:</strong> <%= grocery.price %></span>
                                                <span class="macroCategory"><strong>Macro Category:</strong> <%= grocery.macros %></span><br>
                                                <span class="foodType"><strong>Food Type:</strong> <%= grocery.foodType %></span><br>
                                                <span class="mealType"><strong>Meal Type:</strong> <%= grocery.mealType %></span>
                                            </div>
                                            <% if (user && user._id && grocery && grocery.user && grocery.user.toString() === user._id.toString()) { %>
                                                <form action="/groceries/deleteGroceries/<%= grocery._id %>?_method=DELETE" method="POST">
                                                    <button class="btn btn-danger" type="submit">Delete</button>
                                                </form>
                                            <% } %>
                                        </li>
                                    <% }) %>
                                </ul>
                            </div>
                            <div class="col-sm-6 counts">
                                <div class="expiring-in-week">
                                    <!-- Display expiring items within 7 days -->
                                    <h3>Expiring Items Within 7 Days</h3>
                                    <ul>
                                        <% expiringItems.forEach(expiringItem => { %>
                                            <li>
                                                <%= expiringItem.groceries %> - <%= new Date(expiringItem.expirationDate).toLocaleDateString() %>
                                            </li>
                                        <% }) %>
                                    </ul>
                                </div>
                                <div class="all-items-expiring">
                                    <!-- Display all items sorted by expiration date -->
                                    <h3>All Items Sorted by Expiration Date</h3>
                                    <ul>
                                        <% groceries.sort((a, b) => new Date(a.expirationDate) - new Date(b.expirationDate)).forEach(item => { %>
                                            <li>
                                                <%= item.groceries %> - <%= new Date(item.expirationDate).toLocaleDateString() %>
                                            </li>
                                      <% }) %>
                                    </ul>
                                </div>
                                <div class="category-counts">
                                    <div class="heading">
                                        <h3>Meal Type Counts</h3>
                                    </div>
                                    <div class="macro-content">
                                        <div class="macro-div item-list">
                                            <% Object.keys(mealTypeCounts).forEach(mealType => { %>
                                                <h4><%= mealType %></h4>
                                                <ul>
                                                  <% groceries.filter(item => item.mealType === mealType).forEach(item => { %>
                                                    <li><%= item.groceries %></li>
                                                  <% }) %>
                                                </ul>
                                              <% }) %>
                                        </div>
                                        <div class="macro-div count-list">
                                            <ul>
                                                <% Object.keys(mealTypeCounts).forEach(mealType => { %>
                                                    <li>    
                                                        <%= mealType %>: <%= mealTypeCounts[mealType] %>
                                                    </li>
                                                <% }) %>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="category-counts">
                                    <div class="heading">
                                        <h3>Macro Category Counts</h3>
                                    </div>
                                    <div class="macro-content">
                                        <div class="macro-div item-list">
                                            <% Object.keys(categoryCounts).forEach(category => { %>
                                                <h4><%= category %></h4>
                                                <ul>
                                                    <% groceries.filter(item => item.macros === category).forEach(item => { %>
                                                        <li><%= item.groceries %></li>
                                                    <% }) %>
                                                </ul>
                                            <% }) %>
                                        </div>
                                        <div class="macro-div count-list">
                                            <ul>
                                                <% Object.keys(categoryCounts).forEach(category => { %>
                                                    <li><%= category %>: <%= categoryCounts[category] %></li>
                                                <% }) %>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="category-counts">
                                    <div class="heading">
                                        <h3>Food Type Counts</h3>
                                    </div>
                                    <div class="macro-content">
                                        <div class="macro-div item-list">
                                            <% Object.keys(foodTypeCounts).forEach(foodType => { %>
                                                <h4><%= foodType %></h4>
                                                <ul>
                                                  <% groceries.filter(item => item.foodType === foodType).forEach(item => { %>
                                                    <li><%= item.groceries %></li>
                                                  <% }) %>
                                                </ul>
                                              <% }) %>
                                        </div>
                                        <div class="macro-div count-list">
                                            <ul>
                                                <% Object.keys(foodTypeCounts).forEach(foodType => { %>
                                                    <li>
                                                        <%= foodType %>: <%= foodTypeCounts[foodType] %>
                                                    </li>
                                                <% }) %>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Service End -->

         <!-- Footer Start -->
         <div class="container-fluid bg-primary text-light footer wow fadeIn" data-wow-delay="0.1s">
            <div class="container py-5 px-lg-5">
                <div class="row g-5">
                    <div class="col-md-6 col-lg-3">
                        <p class="section-title text-white h5 mb-4">Address<span></span></p>
                        <p><i class="fa fa-map-marker-alt me-3"></i>123 Street, New York, USA</p>
                        <p><i class="fa fa-phone-alt me-3"></i>774-128-9694</p>
                        <p><i class="fa fa-envelope me-3"></i>nourishnest@nest.com</p>
                        <div class="d-flex pt-2">
                            <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-twitter"></i></a>
                            <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-facebook-f"></i></a>
                            <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-instagram"></i></a>
                            <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-linkedin-in"></i></a>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <p class="section-title text-white h5 mb-4">Quick Link<span></span></p>
                        <a class="btn btn-link" href="/about">About Us</a>
                        <a class="btn btn-link" href="">Privacy Policy</a>
                        <a class="btn btn-link" href="">Terms & Condition</a>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <p class="section-title text-white h5 mb-4">Gallery<span></span></p>
                        <div class="row g-2">
                            <div class="col-4">
                                <img class="img-fluid" src="img/brain-3.png" alt="Image">
                            </div>
                            <div class="col-4">
                                <img class="img-fluid" src="img/amino-acids.png" alt="Image">
                            </div>
                            <div class="col-4">
                                <img class="img-fluid" src="img/brain-gut.jpeg" alt="Image">
                            </div>
                            <div class="col-4">
                                <img class="img-fluid" src="img/fiber-img.jpeg" alt="Image">
                            </div>
                            <div class="col-4">
                                <img class="img-fluid" src="img/carbs.jpeg" alt="Image">
                            </div>
                            <div class="col-4">
                                <img class="img-fluid" src="img/mood-follows-food.png" alt="Image">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <p class="section-title text-white h5 mb-4">Newsletter<span></span></p>
                        <p>Find out how to regulate your gut on this months newsletter brought to you by Dr. Spinner</p>
                        <div class="position-relative w-100 mt-3">
                            <input class="form-control border-0 rounded-pill w-100 ps-4 pe-5" type="text" placeholder="Your Email" style="height: 48px;">
                            <button type="button" class="btn shadow-none position-absolute top-0 end-0 mt-1 me-2"><i class="fa fa-paper-plane text-primary fs-4"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container px-lg-5">
                <div class="copyright">
                    <div class="row">
                        <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                            &copy; <a class="border-bottom" href="#">Nourish Nest</a>, All Right Reserved. 
                        </div>
                        <div class="col-md-6 text-center text-md-end">
                            <div class="footer-menu">
                                <a href="/home">Home</a>
                                <a href="/about">About</a>
                                <a href="/groceries">Groceries</a>
                                <a href="/meals">Meals</a>
                                <a href="/blog">Blog</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Footer End -->


        <!-- Back to Top -->
        <a href="#" class="btn btn-lg btn-secondary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/lib/wow/wow.min.js"></script>
    <script src="/lib/easing/easing.min.js"></script>
    <script src="/lib/waypoints/waypoints.min.js"></script>
    <script src="/lib/counterup/counterup.min.js"></script>
    <script src="/lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="/lib/isotope/isotope.pkgd.min.js"></script>
    <script src="/lib/lightbox/js/lightbox.min.js"></script>

    <!-- Template Javascript -->
    <script src="/main.js"></script>
</body>

</html>